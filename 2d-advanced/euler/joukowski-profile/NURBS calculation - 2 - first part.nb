(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15830,        373]
NotebookOptionsPosition[     15086,        343]
NotebookOutlinePosition[     15434,        358]
CellTagsIndexPosition[     15391,        355]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6.316429324549212`"}], ",", 
       RowBox[{"-", "0.05971932426343869`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6.261518584985394"}], ",", " ", 
       RowBox[{"-", "0.18505569380778952"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6.174448795443386"}], ",", 
       RowBox[{"-", "0.30082088021577325"}]}], " ", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5.795913003013248`"}], ",", 
       RowBox[{"-", "0.531126914919711`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5.671973785830416`"}], ",", 
       RowBox[{"-", "0.5686196150097141`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5.529434736355465`"}], ",", 
       RowBox[{"-", "0.5995912481297743`"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"Accumulate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{
        RowBox[{"pts", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", "pts", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"param", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"dist", "/", 
       RowBox[{"Last", "[", "dist", "]"}]}], ",", "0"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "pts", "]"}]}], "Input",
 CellChangeTimes->{
  3.525445317599216*^9, {3.525445348742997*^9, 3.5254453572284822`*^9}, {
   3.5254461251714067`*^9, 3.5254461457165813`*^9}, {3.525448689649086*^9, 
   3.525448692655258*^9}, {3.5254489056794424`*^9, 3.5254489381172976`*^9}, {
   3.525449020831029*^9, 3.5254490643705187`*^9}, {3.5254491135873337`*^9, 
   3.5254491703535805`*^9}, {3.5254497548590126`*^9, 
   3.5254497557630644`*^9}, {3.5254498789311094`*^9, 3.525449952411312*^9}, 
   3.5254500401693316`*^9, {3.525450275833811*^9, 3.525450283880271*^9}, 
   3.5254503385373974`*^9, 3.525452784985326*^9, {3.5254528247706013`*^9, 
   3.525452837177311*^9}, {3.5254530464182787`*^9, 3.52545304801737*^9}, {
   3.525453902635252*^9, 3.525453905858436*^9}, 3.525454191480773*^9, 
   3.5254543001439877`*^9, {3.525456097029764*^9, 3.5254561036471424`*^9}, 
   3.525456204695922*^9, 3.5254950239645042`*^9, {3.525518682502308*^9, 
   3.5255187333102136`*^9}, {3.525518770758355*^9, 3.525518775525628*^9}, {
   3.525519224270295*^9, 3.5255193262701287`*^9}, {3.5255194716224422`*^9, 
   3.5255194717654505`*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{{3.525448899936114*^9, 3.525448934753105*^9}, 
   3.5254491721346827`*^9, 3.525449756863127*^9, 3.525449953478373*^9, 
   3.5254500457826524`*^9, 3.525450284345298*^9, 3.5254503417405806`*^9, 
   3.5254514307288666`*^9, 3.5254527872714567`*^9, {3.5254528294358683`*^9, 
   3.5254528377223425`*^9}, 3.5254530504355087`*^9, 3.525453835305401*^9, 
   3.525453906749487*^9, 3.52545395557828*^9, 3.5254541918567944`*^9, 
   3.5254543014380617`*^9, 3.5254561049962196`*^9, 3.5254562054969683`*^9, 
   3.525494981445072*^9, 3.5254950243075237`*^9, 3.5255186681344852`*^9, {
   3.525518706438677*^9, 3.525518776909707*^9}, {3.525519281988596*^9, 
   3.525519327045173*^9}, 3.525519472213476*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"i", " ", "/", " ", "7."}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy2kog3EAx/GHRG1FqDVZY1ceR5sXa6ZEG1IkM7UauVaE5JiVpBb1zJQ5
yvBCjlYzrcSLJaHFG7FQCHPkKm/WiuQoR3l+/xffPq++IlOnvimSoighG7SN
9Wg0RSFNVnJICymTj9aycuqUcig57lJD5t5HrJiv34ICYZUffi1Yz+FTxCtx
2Xx4BX/cDddQSmeE4cCZnegq6HgjP71O9H72/sJc0w6x/JvPLWRtbB2MhdkZ
AQEscbWlwuaTeBoeGPIV8IGpzoUyh4foX5oqhd3v/DK4wbtj4ESwxQ4TvNP7
kMtJC8BN81cQ9mlfb+D1kM1WxKqbPiVe3qaPwp05yzg0qMYmoce/OgOj9t0L
0HEUswirZaW78Hn0lmhaE33AYaOFGJ0T5BSzJjIKLsw83hPDuEClBFofnQqo
Wrkg6lxOJQyncNRQPhKfB7d1emKN9IVvZP3rr02CAl67EDpnDWL4D0Hi2gM=

  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.14285714285714285`", ",", "0.2857142857142857`", ",", 
   "0.42857142857142855`", ",", "0.5714285714285714`", ",", 
   "0.7142857142857142`", ",", "0.8571428571428571`", ",", "1.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.525454222214531*^9, 3.525454272775423*^9}, 
   3.525454306855372*^9, 3.5254949882594624`*^9, {3.525495029906844*^9, 
   3.52549505902551*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"knots", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0.3333333333333", ",", " ", 
     "0.66666666666666666", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.525445385421095*^9, 3.5254454190520186`*^9}, {
   3.525445477316351*^9, 3.5254455897997847`*^9}, {3.5254461722350984`*^9, 
   3.5254463041176414`*^9}, {3.5254463429588633`*^9, 3.525446352503409*^9}, {
   3.5254464715192165`*^9, 3.5254464864870725`*^9}, {3.5254465632064605`*^9, 
   3.5254465733270397`*^9}, {3.5254466194546776`*^9, 
   3.5254468139378014`*^9}, {3.5254468692349644`*^9, 
   3.5254469602391696`*^9}, {3.525447284423712*^9, 3.5254474583426595`*^9}, {
   3.5254492118279533`*^9, 3.5254492771486893`*^9}, {3.5254493190130835`*^9, 
   3.5254493411093473`*^9}, {3.5254493980456038`*^9, 3.525449413901511*^9}, {
   3.525449448488489*^9, 3.5254494571899867`*^9}, {3.525449535639474*^9, 
   3.5254497212640915`*^9}, {3.5254497933512144`*^9, 
   3.5254498604370513`*^9}, {3.5254499645900087`*^9, 3.525450001428116*^9}, {
   3.5254500555512114`*^9, 3.525450128906407*^9}, {3.5254501673066034`*^9, 
   3.5254502143942966`*^9}, {3.525452855302348*^9, 3.525452862261746*^9}, {
   3.525452912400614*^9, 3.525453002093744*^9}, {3.525453061376135*^9, 
   3.5254531266588683`*^9}, {3.525453222090327*^9, 3.525453293179393*^9}, {
   3.525453331218569*^9, 3.525453372588935*^9}, {3.525453745229249*^9, 
   3.5254537571869326`*^9}, {3.5254537935870147`*^9, 3.525453801796484*^9}, {
   3.5254538446669364`*^9, 3.5254538551635365`*^9}, {3.52545391780612*^9, 
   3.5254539244504995`*^9}, {3.52545405540199*^9, 3.52545407445708*^9}, {
   3.5254541137463264`*^9, 3.5254541187296114`*^9}, {3.5254542259857464`*^9, 
   3.525454315967893*^9}, {3.525494992109682*^9, 3.5254949962609196`*^9}, {
   3.5254950334210453`*^9, 3.525495042876586*^9}, {3.525519315660522*^9, 
   3.5255193158915353`*^9}, 3.5255194789658623`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"BSplineBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "knots"}], "}"}], ",", 
       RowBox[{"j", "-", "1"}], ",", 
       RowBox[{"param", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "pts", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "pts", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "m", "]"}]}], "Input",
 CellChangeTimes->{{3.5254455551168013`*^9, 3.52544556540339*^9}, {
   3.5254462819973764`*^9, 3.525446284845539*^9}, 3.5254464671569667`*^9, 
   3.525446559925273*^9, 3.5254467174452825`*^9, {3.5254467522452726`*^9, 
   3.525446752324278*^9}, 3.5254468653007393`*^9, {3.5254469303254585`*^9, 
   3.5254469313085146`*^9}, {3.525446992709027*^9, 3.5254470796690006`*^9}, {
   3.525447117844184*^9, 3.5254471182142053`*^9}, 3.5254492306290283`*^9, {
   3.525449533437348*^9, 3.525449549277254*^9}, 3.525449611364805*^9, 
   3.5254496578614645`*^9, 3.52544978872495*^9, 3.525450165237485*^9, {
   3.52545031882927*^9, 3.5254503458768167`*^9}, 3.525452866165969*^9, 
   3.525453319860919*^9, {3.5254536353649645`*^9, 3.525453723693017*^9}, 
   3.5254538406537066`*^9, {3.52545392673363*^9, 3.525453930700857*^9}, {
   3.5254541782770176`*^9, 3.525454201205329*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9999999999999999`", "0.`", "0.`", "0.`", "0", "0"},
     {"0.2049028383620463`", "0.5942491134700655`", "0.18932281882940166`", 
      "0.011525229338486409`", "0", "0"},
     {"0.003726719465866939`", "0.37778575695068767`", "0.5179430881335749`", 
      "0.10054443544987048`", "0", "0"},
     {"0", "0", "0.09390709492928494`", "0.5067828344249836`", 
      "0.3940368346554824`", "0.0052732359902488875`"},
     {"0", "0", "0.013960209247516002`", "0.21037627038029094`", 
      "0.5977197487608407`", "0.1779437716113522`"},
     {"0", "0", "0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5254472519318533`*^9, {3.525447286726844*^9, 3.5254473633192244`*^9}, {
   3.525447398525238*^9, 3.5254474600787587`*^9}, {3.5254492221895456`*^9, 
   3.5254492794408207`*^9}, {3.5254493211262045`*^9, 
   3.5254493441345205`*^9}, {3.525449406836107*^9, 3.5254494148215637`*^9}, 
   3.5254494584460588`*^9, {3.525449537446577*^9, 3.5254495561296463`*^9}, {
   3.525449587190422*^9, 3.525449591330659*^9}, {3.525449640050446*^9, 
   3.5254497226181684`*^9}, 3.525449761241378*^9, {3.525449799496566*^9, 
   3.525449832381447*^9}, 3.525449862553172*^9, {3.5254499735595217`*^9, 
   3.5254500023841705`*^9}, {3.525450062835628*^9, 3.5254501300864744`*^9}, {
   3.525450170816804*^9, 3.525450216465415*^9}, {3.525450289482591*^9, 
   3.525450346323842*^9}, 3.5254528691761417`*^9, {3.5254529469325886`*^9, 
   3.5254529728280697`*^9}, 3.525453005939964*^9, {3.525453069060574*^9, 
   3.5254531286739836`*^9}, {3.525453227011608*^9, 3.5254532594754653`*^9}, 
   3.525453294635476*^9, {3.5254533492065973`*^9, 3.5254533737680025`*^9}, {
   3.5254536363120193`*^9, 3.525453670828993*^9}, {3.525453705529978*^9, 
   3.525453724485062*^9}, {3.525453759642073*^9, 3.525453804151619*^9}, {
   3.525453840991726*^9, 3.5254538580457015`*^9}, 3.5254539311878853`*^9, 
   3.525453963813751*^9, 3.5254540216050563`*^9, 3.5254540762541823`*^9, 
   3.5254541203687057`*^9, {3.525454178620037*^9, 3.525454201853366*^9}, {
   3.5254542336211834`*^9, 3.5254542825279803`*^9}, 3.525454318250024*^9, 
   3.525456114597769*^9, 3.5254562170076265`*^9, 3.5254949989570737`*^9, 
   3.5254950449477043`*^9, {3.5255193202027817`*^9, 3.52551933188945*^9}, 
   3.5255194814760065`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ctrlpts", " ", "=", " ", 
  RowBox[{"LeastSquares", "[", 
   RowBox[{"m", ",", " ", "pts"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"pts", ",", 
   RowBox[{"Prolog", "\[Rule]", 
    RowBox[{"BSplineCurve", "[", "ctrlpts", "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Red", ",", 
      RowBox[{"PointSize", "[", "Medium", "]"}]}], "]"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.525445599014312*^9, 3.5254456154912543`*^9}, {
   3.5254464442446566`*^9, 3.5254464463637776`*^9}, {3.5254465040120745`*^9, 
   3.525446506396211*^9}, {3.5254471898002996`*^9, 3.5254472250683165`*^9}, 
   3.525447376652987*^9, {3.5254474839741254`*^9, 3.5254475036142488`*^9}, {
   3.525449294278669*^9, 3.525449301357074*^9}, 3.5254493539730835`*^9, {
   3.525449474012949*^9, 3.525449477493148*^9}, 3.525450244133998*^9, {
   3.5254503634138203`*^9, 3.5254503759175353`*^9}, 3.525452637797907*^9, {
   3.5254561455335383`*^9, 3.5254561686218586`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.316429324549205`"}], ",", 
     RowBox[{"-", "0.05971932426343828`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.284252109313268`"}], ",", 
     RowBox[{"-", "0.16701471920046035`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.155539717080489`"}], ",", 
     RowBox[{"-", "0.35664106361572145`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.854019096251829`"}], ",", 
     RowBox[{"-", "0.5249695505470973`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.639040694683198`"}], ",", 
     RowBox[{"-", "0.5797134319705062`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.529434736355461`"}], ",", 
     RowBox[{"-", "0.599591248129774`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.525456146127572*^9, 3.5254561695429115`*^9}, 
   3.52545621934276*^9, 3.5254950004341583`*^9, 3.5254950462297773`*^9, 
   3.525519333411537*^9, 3.525519483059097*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[1, 0, 0], PointSize[Medium], 
    PointBox[{{-6.316429324549212, -0.05971932426343869}, \
{-6.261518584985394, -0.18505569380778952`}, {-6.174448795443386, \
-0.30082088021577325`}, {-5.795913003013248, -0.531126914919711}, \
{-5.671973785830416, -0.5686196150097141}, {-5.529434736355465, \
-0.5995912481297743}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{-6.8, 0},
  PlotRange->{{-6.316429324549212, -5.529434736355465}, {-0.5995912481297743, 
   0.}},
  PlotRangeClipping->True,
  PlotRangePadding->NCache[
    Rational[1, 2], 0.5],
  Prolog->
   BSplineCurveBox[{{-6.316429324549205, -0.05971932426343828}, \
{-6.284252109313268, -0.16701471920046035`}, {-6.155539717080489, \
-0.35664106361572145`}, {-5.854019096251829, -0.5249695505470973}, \
{-5.639040694683198, -0.5797134319705062}, {-5.529434736355461, \
-0.599591248129774}}]]], "Output",
 CellChangeTimes->{{3.525456146127572*^9, 3.5254561695429115`*^9}, 
   3.52545621934276*^9, 3.5254950004341583`*^9, 3.5254950462297773`*^9, 
   3.525519333411537*^9, 3.525519483064097*^9}]
}, Open  ]]
},
WindowSize->{952, 1145},
WindowMargins->{{Automatic, -22}, {Automatic, 196}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (February 24, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 2901, 71, 132, "Input"],
Cell[3483, 95, 735, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4255, 110, 712, 16, 31, "Input"],
Cell[4970, 128, 414, 9, 30, "Output"]
}, Open  ]],
Cell[5399, 140, 1980, 31, 31, "Input"],
Cell[CellGroupData[{
Cell[7404, 175, 1486, 31, 52, "Input"],
Cell[8893, 208, 2813, 49, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11743, 262, 1121, 21, 72, "Input"],
Cell[12867, 285, 1060, 29, 50, "Output"],
Cell[13930, 316, 1140, 24, 226, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
